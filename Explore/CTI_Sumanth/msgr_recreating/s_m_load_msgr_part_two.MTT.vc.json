{
  "name" : "s_m_load_msgr_part_two",
  "runtimeEnvironmentId" : "@3pADNCV9u0PcgrXjM7rx0t",
  "runtimeEnvironmentName" : "sag_aws_linux",
  "maxLogs" : 10,
  "parameters" : [
    {
      "name" : "$SQ_core_msgr_part_two$",
      "type" : "SOURCE",
      "label" : "DBConnection_SRC",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_SRC",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_SRC",
        "isSelectDistinct" : "false",
        "objectParameterized" : "false",
        "visible" : "false",
        "originalPath" : "SQ_core_msgr_part_two"
      },
      "sourceConnectionId" : "@aYZ4ekzHgIPeKpiaoqDLKP",
      "connectionName" : "redshift_nonprod_andover_dw_dev",
      "sourceObject" : "DUMMY_SQ_core_msgr_part_two",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "customFuncCfg" : { },
      "customQuery" : "select distinct\n\t   f.\"account entered dt\",\n       f.\"accident dt\",\n       f.\"book dt\",\n       f.\"claim key\",\n       f.\"claim type\",\n       f.\"independent adjuster\",\n       f.\"loss ulae expense\",\n       f.\"loss cause id\",\n       f.\"loss paid amt\",\n       f.\"loss paid recovery amt\",\n       f.\"loss reserve amt\",\n       f.\"loss reserve for incurred loss\",\n       f.\"loss salvage amt\",\n       f.\"loss subrogation amt\",\n       f.\"major peril id\",\n       f.\"policy key\",\n       f.\"policy key code\",\n       f.\"reported dt\",\n       f.\"reserve cd\",\n       f.\"state line cd\",\n       f.\"sub loss cause desc\",\n       f.\"transaction date\",\n       p.\"automatic renewal\",\n       p.\"billing type\",\n       p.\"company desc\",\n       p.\"customer number\",\n       p.\"fairplan desc\",\n       p.\"formatted insured address\",\n       p.\"gw policy number\",\n       p.\"inexperienced operator\",\n       p.\"insurance score\",\n       p.\"insurance score desc\",\n       p.\"insured address\",\n       p.\"insured birth dt\",\n       p.\"insured name\",\n       p.\"form\",\n       p.\"lob desc\",\n       p.\"lob group desc\",\n       p.\"module number\",\n       p.\"new renewal desc\",\n       p.\"operator\",\n       p.\"pay plan\",\n       p.\"policy inception date\",\n       p.\"policy effective date\",\n       p.\"policy expiration date\",\n       p.\"policy key\" as p_policy_key,\n       p.\"policy symbol\",\n       p.\"policy transaction dt\",\n       p.\"producer code\",\n       p.\"producer name\",\n       p.\"renewal code desc\",\n       p.\"risk state\",\n       p.\"secondary home desc\",\n       p.\"source cd\",\n       p.\"insurance score run date\",\n       p.\"insurance score run year\",\n       p.\"secondary insurance score desc\",\n       p.\"secondary insurance score\",\n       p.\"secondary insurance score run date\",\n       p.\"secondary insurance score run year\",\n       a.\"agency alpha workflow\",\n       a.\"agency address\",\n       a.\"agency appointed dt\",\n       --a.\"agency code\",\n       CASE\n        WHEN LENGTH(a.\"agency code\") < 4\n        THEN LPAD(a.\"agency code\", 4, '0')\n        ELSE a.\"agency code\"\n        END as \"agency code\",\n       a.\"agency city\",\n       a.\"agency city state\",\n       a.\"agency contact phone\",\n       a.\"agency group\",\n       a.\"agency name\",\n       a.\"agency state\",\n       a.\"agency zip code\",\n       a.\"field representative\",\n       a.\"field representative group\",\n       a.\"group name\",\n       c.\"cat desc\",\n       c.\"cat group desc\",\n       c.\"catastrophe number\",\n       c.\"claim number\",\n       cs.claim_status_display_value,\n       m.\"guidewiremajorperil\",\n       m.\"majorperildisplay\",\n       r.\"age credit amt\",\n       r.\"blanket policy ind\",\n       r.\"building class\",\n       r.\"building class description\",\n       r.\"building limit amt\",\n       r.\"building limit band 1k\",\n       r.\"building limit band 100k\",\n       r.\"building limit band 500k\",\n       r.\"building limits\",\n       r.\"building limits group\",\n       r.\"building num\",\n       r.\"building status\",\n       r.\"commercial liability limit\",\n       r.\"construction type\",\n       r.\"construction year\",\n       r.\"construction year band\",\n       r.\"contents class\",\n       r.\"contents class description\",\n       r.\"contents limits\",\n       r.\"cov a premium\",\n       r.\"cov c premium\",\n       r.\"deductible\",\n       r.\"distancetoshore band\",\n       r.\"distance to shore feet\",\n       r.\"distance to shore mile\",\n       r.\"dupc credit amt\",\n       r.\"elevation\",\n       r.\"elite package ind\",\n       r.\"expense mod\",\n       r.\"formattedcounty\",\n       r.\"formattedstreet\",\n       r.\"formattedriskaddress\",\n       r.\"formattedriskcity\",\n       r.\"formattedrisklatitude\",\n       r.\"formattedrisklongitude\",\n       r.\"formattedriskzipcode\",\n       r.\"flood zone\",\n       r.\"individual risk premium mod\",\n       r.\"latitude\",\n       r.\"liability limit\",\n       r.\"longitude\",\n       r.\"num buildings complex\",\n       r.\"num vehicles\",\n       r.\"number of apartments\",\n       r.\"number of apartments band\",\n       r.\"number of apartments condo\",\n       r.\"number of families\",\n       r.\"number of stories\",\n       r.\"occupancy\",\n       r.\"per unit deductible amt\",\n       r.\"per unit deductible type\",\n       r.\"personal umbrella limit\",\n       r.\"policy key code\" as r_polic_key_code,\n       r.\"prc credit\",\n       r.\"protection class\",\n       r.\"rating territory\",\n       r.\"rating territory desc\",\n       r.\"risk address\",\n       r.\"risk county\",\n       r.\"risk city\",\n       r.\"risk zip\",\n       r.\"sircoastline band\",\n       r.\"sir coastline feet\",\n       r.\"sir coastline mile\",\n       r.\"sprinkler\",\n       r.\"sq feet area\",\n       r.\"sq feet area band\",\n       r.\"total insured value\",\n       r.\"water backup limit\",\n       r.\"wind deductible amt\",\n       r.\"wind deductible type\",\n       cov.\"policykey\" as coverage_policy_key,\n       cov.\"riskid\",\n       cov.\"coverageid\",\n       cov.\"coveragelimit1\",\n       cov.\"coveragelimit2\",\n       cov.\"coveragelimit3\",\n       cov.\"coveragelimit4\",\n       cov.\"coveragedeductible\",\n       cov.\"coveragedesc\",\n       ad.\"attachadddt\",\n       r.\"contents limit amt\",\n       f.\"loss alae expense\",\n       a.\"agency id\",\n       f.\"policy coverage code\" ,\n       p.\"shell policy ind\",\n       f.feature_code,\n       f.sub_feature_code,\n       ft.featuredesc,\n       f.\"annual statement line cd\",\n       TGT.row_id,\n       TGT.md5_hash_value,\n\t   f.msgr_part_two_key,\n\t   f.msgr_last_update_date\nfrom\n(select  \"account entered dt\",\n       \"accident dt\",\n       \"book dt\",\n       \"claim key\",\n       \"claim type\",\n       \"independent adjuster\",\n       \"loss ulae expense\",\n       \"loss cause id\",\n       \"loss paid amt\",\n       \"loss paid recovery amt\",\n       \"loss reserve amt\",\n       \"loss reserve for incurred loss\",\n       \"loss salvage amt\",\n       \"loss subrogation amt\",\n       \"major peril id\",\n       \"policy key\",\n       \"policy key code\",\n       \"reported dt\",\n       \"reserve cd\",\n       \"state line cd\",\n       \"sub loss cause desc\",\n       \"transaction date\",\n       \"loss alae expense\",\n       \"policy coverage code\",\n       feature_code,\n       sub_feature_code,\n\t   \"annual statement line cd\",\n\t  'part_two||' || claimstatsystemid as msgr_part_two_key,\n\t  msgr_last_update_date,\n\t  feature_id,\n\t  \"claim number\",\n\t  \"risk id\",\n\t  \"part policy key\",\n\t  \"coverage id\"\nfrom dbo.msgr_view_loss_fact )f\nLEFT JOIN dbo.feature ft\n  ON f.feature_id::text = ft.featureid::text AND\n     f.\"claim number\"::text = ft.claimnumber::text\nand ft.featuredesc IS NOT NULL\n  AND ft.roweffenddt > 'now'::character varying::timestamp without time zone\ninner join dbo.msgr_view_policy p on p.\"policy key\" = f.\"policy key\"\nleft outer join dbo.msgr_view_master_agency a on a.\"agency code\" = p.\"agency code\"\nleft outer join dbo.msgr_view_claim c on c.\"claim key\" = f.\"claim key\"\nleft outer join dbo.claimstatus_ref cs on c.\"claim status\" = cs.\"claim_status\"\nleft outer join dbo.majorperil_ref m on m.\"guidewiremajorperil\" = f.\"major peril id\"\nleft outer join dbo.msgr_view_rating r on r.\"policy key code\" = f.\"policy key code\"\nleft outer join dbo.coverage cov on f.\"part policy key\" = cov.\"policykey\"\n\tand f.\"risk id\" = cov.\"riskid\"\n\tand f.\"coverage id\" = cov.\"coverageid\"\n\tand cov.\"coveragestatus\" = 'Active'\n\tand cov.\"roweffenddt\" = '9999-12-31 00:00:00.000000'\nleft join dbo.msgr_attachmentdetail ad on p.\"gw policy number\" = ad.\"policynum\"\nleft join dbo.msgr_part_two TGT\nON f.msgr_part_two_key = TGT.msgr_part_two_key\nwhere (f.msgr_last_update_date >= (SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\nor p.msgr_last_update_date >= (SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\nor a.msgr_last_update_date >= (SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\nor c.msgr_last_update_date >= (SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\nor r.msgr_last_update_date >= (SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\nor ad.msgr_last_update_date >= (SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3'))\n--ft, cs, m, and cov do not have columns that truck updates to check for in the where clause",
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "DUMMY_SQ_core_msgr_part_two",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "fetchMode" : "ORIGINAL",
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_SRC",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$msgr_part_two_insert$",
      "type" : "TARGET",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "default" : "dbo/msgr_part_two",
        "objectParameterized" : "false",
        "visible" : "false",
        "supportApplyDDLChanges" : "false",
        "originalPath" : "msgr_part_two_insert"
      },
      "targetConnectionId" : "@aYZ4ekzHgIPeKpiaoqDLKP",
      "connectionName" : "redshift_nonprod_andover_dw_dev",
      "targetObject" : "dbo/msgr_part_two",
      "targetObjectLabel" : "msgr_part_two",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "operationType" : "Rowbased",
      "customFuncCfg" : { },
      "extendedObject" : {
        "singleMode" : true
      },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "dbo/msgr_part_two",
      "objectLabel" : "msgr_part_two",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "fetchMode" : "ORIGINAL",
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$msgr_part_two_update$",
      "type" : "TARGET",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "default" : "dbo/msgr_part_two",
        "objectParameterized" : "false",
        "visible" : "false",
        "defaultTargetUpdateColumns" : "row_id",
        "supportApplyDDLChanges" : "false",
        "originalPath" : "msgr_part_two_update"
      },
      "targetConnectionId" : "@aYZ4ekzHgIPeKpiaoqDLKP",
      "connectionName" : "redshift_nonprod_andover_dw_dev",
      "targetObject" : "dbo/msgr_part_two",
      "targetObjectLabel" : "msgr_part_two",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "operationType" : "Rowbased",
      "customFuncCfg" : { },
      "targetUpdateColumns" : [
        "row_id"
      ],
      "extendedObject" : {
        "singleMode" : true
      },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "dbo/msgr_part_two",
      "objectLabel" : "msgr_part_two",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "fetchMode" : "ORIGINAL",
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    }
  ],
  "verbose" : false,
  "mappingId" : "@h7OMqE9szgufLd9QM2u0Gn",
  "mappingTemplateName" : "m_load_msgr_part_two",
  "sessionPropertiesList" : [
    {
      "name" : "Pushdown Optimization",
      "value" : "None"
    },
    {
      "name" : "Pushdown Optimization Context",
      "value" : "None"
    },
    {
      "name" : "Pushdown Optimization Fallback Option",
      "value" : "Partial PDO"
    }
  ],
  "hidden" : false,
  "enableCrossSchemaPushdown" : true,
  "enableParallelRun" : false,
  "autoTunedApplied" : false,
  "autoTunedAppliedType" : "NONE",
  "parameterFileName" : "Andover_Parm_Peregrine.txt",
  "parameterFileDir" : "$PMRootDir/andover/parameters",
  "paramFileType" : "PARAM_FILE_LOCAL",
  "schemaMode" : "async",
  "valid" : true,
  "optimizationPlan" : "NONE",
  "allowMaxFieldLength" : false,
  "specialCharacterSupport" : false,
  "midstreamPreview" : false,
  "vcsExportTime" : "2026-01-31 06:37:06 PST"
}