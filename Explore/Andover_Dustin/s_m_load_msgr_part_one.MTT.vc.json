{
  "name" : "s_m_load_msgr_part_one",
  "description" : "Session pushed from PC to ICS : s_m_load_msgr_part_one",
  "runtimeEnvironmentId" : "@3pADNCV9u0PcgrXjM7rx0t",
  "runtimeEnvironmentName" : "sag_aws_linux",
  "maxLogs" : 10,
  "parameters" : [
    {
      "name" : "$SQ_core_msgr_part_one$",
      "type" : "SOURCE",
      "label" : "DBConnection_SRC",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_SRC",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_SRC",
        "isSelectDistinct" : "false",
        "objectParameterized" : "false",
        "visible" : "false",
        "originalPath" : "SQ_core_msgr_part_one"
      },
      "sourceConnectionId" : "@aYZ4ekzHgIPeKpiaoqDLKP",
      "connectionName" : "redshift_nonprod_andover_dw_dev",
      "sourceObject" : "DUMMY_SQ_core_msgr_part_one",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "customFuncCfg" : { },
      "customQuery" : "select DISTINCT\n    f.account_entered_dt,\n    f.inforce_policy_key,\n    f.commission_amount,\n    f.earned_premium,\n    f.inforce_premium,\n    f.major_peril_id,\n    f.policy_coverage_code,\n    f.policy_key,\n    f.policy_key_code,\n    f.taxes_service_charges,\n    f.unearned_premium,\n    f.written_premium,\n    f.annual_statement_line, \n    f.stat_line_cd,\n    f.msgr_part_one_key,\n    p.\"agency code\",\n    p.\"automatic renewal\",\n    p.\"billing type\",\n    p.\"company desc\",\n    p.\"customer number\",\n    p.\"fairplan desc\",\n    p.form,\n    p.\"formatted insured address\",\n    p.\"gw policy number\",\n    p.\"inexperienced operator\",\n    p.\"insurance score\",\n    p.\"insurance score desc\",\n    p.\"insured address\",\n    p.\"insured birth dt\",\n    p.\"insured name\",\n    p.\"lob desc\",\n    p.\"lob group desc\",\n    p.\"module number\",\n    p.\"new renewal desc\",\n    p.operator,\n    p.\"part policy key\",\n    p.\"pay plan\",\n    p.\"policy inception date\",\n    p.\"policy effective date\",\n    p.\"policy expiration date\",\n    p.\"policy key\",\n    p.\"policy symbol\",\n    p.\"policy transaction dt\",\n    p.\"producer code\",\n    p.\"producer name\",\n    p.\"renewal code desc\",\n    p.\"risk state\",\n    p.\"secondary home desc\",\n    p.\"source cd\",\n    p.\"insurance score run date\",\n    p.\"insurance score run year\",\n    p.\"secondary insurance score run date\",\n    p.\"secondary insurance score run year\",\n    p.\"secondary insurance score\",\n    p.\"secondary insurance score desc\",\n    a.\"agency address\",\n    a.\"agency alpha workflow\",\n    a.\"agency appointed dt\",\n    a.\"agency city\",\n    a.\"agency city state\",\n    CASE \n        WHEN LEN(a.\"agency code\") < 4 \n        THEN LPAD(a.\"agency code\",4,'0')\n        ELSE a.\"agency code\"\n    END as \"agency code\",\n    a.\"agency contact phone\",\n    a.\"agency group\",\n    a.\"agency name\",\n    a.\"agency state\",\n    a.\"agency zip code\",\n    a.\"field representative\",\n    a.\"field representative group\",\n    a.\"group name\",\n    m.guidewiremajorperil,\n    m.majorperildisplay,\n    r.\"age credit amt\",\n    r.\"building class\",\n    r.\"blanket policy ind\",\n    r.\"building class description\",\n    r.\"building limit band 1k\",\n    r.\"building limit band 100k\",\n    r.\"building limit band 500k\",\n    r.\"building limits\",\n    r.\"building limit amt\",\n    r.\"building limits group\",\n    r.\"building num\",\n    r.\"building status\",\n    r.\"commercial liability limit\",\n    r.\"construction type\",\n    r.\"construction year\",\n    r.\"construction year band\",\n    r.\"contents class\",\n    r.\"contents class description\",\n    r.\"contents limits\",\n    r.\"contents limit amt\",\n    r.\"cov a premium\",\n    r.\"cov c premium\",\n    r.deductible,\n    r.\"distancetoshore band\",\n    r.\"distance to shore feet\",\n    r.\"distance to shore mile\",\n    r.\"dupc credit amt\",\n    r.elevation,\n    r.\"elite package ind\",\n    r.\"expense mod\",\n    r.\"flood zone\",\n    r.formattedcounty,\n    r.formattedriskaddress,\n    r.formattedriskcity,\n    r.formattedriskzipcode,\n    r.formattedrisklatitude,\n    r.formattedrisklongitude,\n    r.formattedstreet,\n    r.\"individual risk premium mod\",\n    r.latitude,\n    r.\"liability limit\",\n    r.longitude,\n    r.\"num buildings complex\",\n    r.\"num vehicles\",\n    r.\"number of apartments\",\n    r.\"number of apartments band\",\n    r.\"number of apartments condo\",\n    r.\"number of families\",\n    r.\"number of stories\",\n    r.occupancy,\n    r.\"per unit deductible type\",\n    r.\"per unit deductible amt\",\n    r.\"personal umbrella limit\",\n    r.\"policy key code\",\n    r.\"prc credit\",\n    r.\"protection class\",\n    r.\"rating territory\",\n    r.\"rating territory desc\",\n    r.\"risk address\",\n    r.\"risk county\",\n    r.\"risk city\",\n    r.\"risk zip\",\n    r.\"sircoastline band\",\n    r.\"sir coastline feet\",\n    r.\"sir coastline mile\",\n    r.sprinkler,\n    r.\"sq feet area\",\n    r.\"sq feet area band\",\n    r.\"total insured value\",\n    r.\"water backup limit\",\n    r.\"wind deductible amt\",\n    r.\"wind deductible type\",\n    c.policykey,\n    c.riskid,\n    c.coverageid,\n    c.coveragelimit1,\n    c.coveragelimit2,\n    c.coveragelimit3,\n    c.coveragelimit4,\n    c.coveragedeductible,\n    c.coveragedesc,\n    c.roweffenddt,\n    c.coveragestatus,\n    ad.attachadddt,\n    ad.policynum,\n    a.\"agency id\",\n    p.\"shell policy ind\",\n    TGT.row_id,\n    TGT.md5_hash_value\nfrom \n(select account_entered_dt,\n    max(inforce_policy_key) AS inforce_policy_key,\n    sum(COALESCE(commission_amount, 0)) AS commission_amount,\n    sum(COALESCE(earned_premium, 0)) AS earned_premium,\n    sum(COALESCE(inforce_premium, 0)) AS inforce_premium,\n    major_peril_id,\n    policy_coverage_code,\n    policy_key,\n    policy_key_code,\n    sum(COALESCE(taxes_service_charges, 0)) AS taxes_service_charges,\n    sum(COALESCE(unearned_premium, 0)) AS unearned_premium,\n    sum(COALESCE(written_premium, 0)) AS written_premium,\n    annual_statement_line, \n    stat_line_cd,\n    ('part_one||' || policy_key || '||' || COALESCE(policy_key_code,'NULL') || '||' || COALESCE(policy_coverage_code,'NULL') || '||'\n    || COALESCE(major_peril_id,'NULL') || '||' || COALESCE(rateareaname,'NULL') || '||' || account_entered_dt::text) AS msgr_part_one_key,\n    min(rowinsdt) AS rowinsdt\nFROM dbo.fact_agg_gw_premiums\nwhere date_part(year, account_entered_dt) = 2023\nGROUP BY account_entered_dt, major_peril_id, policy_coverage_code, policy_key, policy_key_code, annual_statement_line, stat_line_cd, msgr_part_one_key\n) f\ninner join dbo.msgr_view_policy p on p.\"policy key\" = f.policy_key\nleft outer join dbo.msgr_view_master_agency a on a.\"agency code\" = p.\"agency code\" and a.\"field representative\" != 'Jim Ford'\nleft outer join dbo.majorperil_ref m on m.guidewiremajorperil = f.major_peril_id\nleft outer join dbo.msgr_view_rating r on r.\"policy key code\" = f.policy_key_code\nleft outer join dbo.coverage c on (c.policykey+c.riskid+c.coverageid) = f.policy_coverage_code and c.roweffenddt = '9999-12-31 00:00:00.000' and c.coveragestatus = 'Active'\nleft join dbo.msgr_attachmentdetail ad on ad.policynum = p.\"gw policy number\"\nleft join dbo.msgr_part_one TGT\nON f.msgr_part_one_key = TGT.msgr_part_one_key\nwhere \n-- DATE_PART(year, f.account_entered_dt ) IN ('2020', '2021', '2022', '2023', '2024') AND\n-- account_entered_dt >=dateadd(month, -1, cast(getdate() as date)) AND\n   (f.rowinsdt>=(SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\n       or p.msgr_last_update_date>=(SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\n       or a.msgr_last_update_date>=(SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\n       or r.msgr_last_update_date>=(SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\n       or ad.msgr_last_update_date>=(SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3')\n       or c.roweffstrtdt>=(SELECT etlbatchstartst FROM dbo.loadbatchetldt WHERE loadetltype = 'wf_msgr_part1_part2_part3'))",
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "DUMMY_SQ_core_msgr_part_one",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "fetchMode" : "ORIGINAL",
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_SRC",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$msgr_part_one_insert$",
      "type" : "TARGET",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "default" : "dbo/msgr_part_one",
        "objectParameterized" : "false",
        "visible" : "false",
        "supportApplyDDLChanges" : "false",
        "originalPath" : "msgr_part_one_insert"
      },
      "targetConnectionId" : "@aYZ4ekzHgIPeKpiaoqDLKP",
      "connectionName" : "redshift_nonprod_andover_dw_dev",
      "targetObject" : "dbo/msgr_part_one",
      "targetObjectLabel" : "msgr_part_one",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "operationType" : "Rowbased",
      "customFuncCfg" : { },
      "extendedObject" : {
        "singleMode" : true
      },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "dbo/msgr_part_one",
      "objectLabel" : "msgr_part_one",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "fetchMode" : "ORIGINAL",
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "targetSchemaProviderType" : "SELECTED_OBJECT",
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$msgr_part_one_update$",
      "type" : "TARGET",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "default" : "dbo/msgr_part_one",
        "objectParameterized" : "false",
        "visible" : "false",
        "defaultTargetUpdateColumns" : "row_id",
        "supportApplyDDLChanges" : "false",
        "originalPath" : "msgr_part_one_update"
      },
      "targetConnectionId" : "@aYZ4ekzHgIPeKpiaoqDLKP",
      "connectionName" : "redshift_nonprod_andover_dw_dev",
      "targetObject" : "dbo/msgr_part_one",
      "targetObjectLabel" : "msgr_part_one",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "operationType" : "Rowbased",
      "customFuncCfg" : { },
      "targetUpdateColumns" : [
        "row_id"
      ],
      "extendedObject" : {
        "singleMode" : true
      },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "dbo/msgr_part_one",
      "objectLabel" : "msgr_part_one",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "fetchMode" : "ORIGINAL",
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "targetSchemaProviderType" : "SELECTED_OBJECT",
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    }
  ],
  "verbose" : false,
  "lastRunTime" : 1730245671000,
  "mappingId" : "@igNrJHD2eoMlwJNr4yg0qY",
  "mappingTemplateName" : "m_load_msgr_part_one",
  "sessionPropertiesList" : [
    {
      "name" : "Allow Temporary Sequence for Pushdown",
      "value" : "NO"
    },
    {
      "name" : "Allow Temporary View for Pushdown",
      "value" : "NO"
    },
    {
      "name" : "Commit Interval",
      "value" : "100000"
    },
    {
      "name" : "Data Column Delimiter",
      "value" : "|"
    },
    {
      "name" : "Error Log File Name",
      "value" : "PMError.log"
    },
    {
      "name" : "Pushdown Optimization",
      "value" : "None"
    },
    {
      "name" : "Pushdown Optimization Context",
      "value" : "None"
    },
    {
      "name" : "Pushdown Optimization Fallback Option",
      "value" : "Partial PDO"
    }
  ],
  "hidden" : false,
  "enableCrossSchemaPushdown" : false,
  "enableParallelRun" : false,
  "autoTunedApplied" : false,
  "autoTunedAppliedType" : "NONE",
  "parameterFileName" : "Andover_Parm_Peregrine.txt",
  "parameterFileDir" : "$PMRootDir/andover/parameters",
  "paramFileType" : "PARAM_FILE_LOCAL",
  "schemaMode" : "async",
  "valid" : true,
  "optimizationPlan" : "NONE",
  "allowMaxFieldLength" : false,
  "specialCharacterSupport" : false,
  "midstreamPreview" : false,
  "vcsExportTime" : "2026-01-31 06:41:34 PST"
}