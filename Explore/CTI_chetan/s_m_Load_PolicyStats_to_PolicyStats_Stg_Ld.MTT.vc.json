{
  "name" : "s_m_Load_PolicyStats_to_PolicyStats_Stg_Ld",
  "description" : "Session pushed from PC to ICS : s_m_Load_PolicyStats_to_PolicyStats_Stg_Ld",
  "runtimeEnvironmentId" : "@3pADNCV9u0PcgrXjM7rx0t",
  "runtimeEnvironmentName" : "sag_aws_linux",
  "maxLogs" : 10,
  "parameters" : [
    {
      "name" : "$Src_policystats$",
      "type" : "SOURCE",
      "label" : "DBConnection_SRCM",
      "uiProperties" : {
        "cnxtype" : "MySQL",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_SRCM",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_SRCM",
        "isSelectDistinct" : "false",
        "objectParameterized" : "false",
        "visible" : "false",
        "originalPath" : "Src_policystats"
      },
      "sourceConnectionId" : "@jPo49nVatmzbSnPefVZwCV",
      "connectionName" : "conn_mysql_prod_insurance_now_gw-legacy",
      "sourceObject" : "DUMMY_Src_policystats",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "customFuncCfg" : { },
      "runtimeAttrs" : {
        "Sql Override" : "SELECT policystats.SystemId,\n       policystats.id,\n       policystats.StatSequence,\n       policystats.StatSequenceReplace,\n       policystats.PolicyRef,\n       policystats.ProductVersionIdRef,\n       policystats.PolicyNumber,\n       policystats.PolicyVersion,\n       policystats.LineCd,\n       policystats.TransactionNumber,\n       policystats.CoverageCd,\n       policystats.RiskCd,\n       policystats.RiskTypeCd,\n       policystats.SubTypeCd,\n       policystats.CoverageItemCd,\n       policystats.FeeCd,\n       policystats.EffectiveDt,\n       policystats.ExpirationDt,\n       policystats.CombinedKey,\n       policystats.AddDt,\n       policystats.BookDt,\n       policystats.TransactionEffectiveDt,\n       policystats.AccountingDt,\n       policystats.WrittenPremiumAmt,\n       policystats.WrittenCommissionAmt,\n       policystats.WrittenPremiumFeeAmt,\n       policystats.WrittenCommissionFeeAmt,\n       policystats.EarnDays,\n       policystats.InforceChangeAmt,\n       policystats.PolicyYear,\n       policystats.TermDays,\n       policystats.InsuranceTypeCd,\n       policystats.StartDt,\n       policystats.EndDt,\n       policystats.StatusCd,\n       policystats.NewRenewalCd,\n       policystats.Limit1,\n       policystats.Limit2,\n       policystats.Limit3,\n       policystats.Deductible1,\n       policystats.Deductible2,\n       policystats.AnnualStatementLineCd,\n       policystats.CoinsurancePct,\n       policystats.CoveredPerilsCd,\n       policystats.CommissionKey,\n       policystats.CommissionAreaCd,\n       policystats.RateAreaName,\n       policystats.StatData,\n       policystats.CustomerRef,\n       policystats.ShortRateStatInd,\n       policystats.TransactionCd,\n       policystats.StateCd,\n       policystats.BillMethod,\n       policystats.StatementAccountNumber,\n       policystats.StatementAccountRef,\n       policystats.CarrierGroupCd,\n       policystats.CarrierCd,\n       policystats.ProducerCd,\n       policystats.BusinessSourceCd,\n       policystats.PreviousCarrierCd,\n       policystats.ConstructionCd,\n       policystats.YearBuilt,\n       policystats.SqFt,\n       policystats.Stories,\n       policystats.OccupancyCd,\n       policystats.Units,\n       policystats.ProtectionClass,\n       policystats.TerritoryCd,\n       policystats.PolicyTypeCd,\n       policystats.PolicyStatusCd,\n       policystats.PolicyGroupCd,\n       policystats.CancelReason,\n       policystats.PayPlanCd,\n       policystats.ClassCd,\n       policystats.AgeOfHome,\n       policystats.LocationAddress1,\n       policystats.LocationAddress2,\n       policystats.LocationAddress3,\n       policystats.LocationAddress4,\n       policystats.LocationCity,\n       policystats.LocationCounty,\n       policystats.LocationState,\n       policystats.LocationZip,\n       policystats.LocationRegionCd,\n       policystats.LocationRegionISOCd,\n       policystats.VehicleNumber,\n       policystats.VehicleYear,\n       policystats.VehicleManufacturer,\n       policystats.VehicleModel,\n       policystats.VehicleType,\n       policystats.DriverNumber,\n       policystats.DriverFirst,\n       policystats.DriverMI,\n       policystats.DriverAge,\n       policystats.DriverLast,\n       policystats.DriverGenderCd,\n       policystats.RelationshipToInsuredCd,\n       policystats.DriverStartDt,\n       policystats.PointsChargeable,\n       policystats.PointsCharged,\n       policystats.Limit4,\n       policystats.Limit5,\n       policystats.Limit6,\n       policystats.ControllingStateCd,\n       policystats.ControllingProductVersionIdRef,\n       policystats.DividendPlanCd,\n       policystats.ConversionTemplateIdRef,\n       policystats.ConversionGroup,\n       policystats.ConversionJobRef,\n       policystats.ConversionFileName,\n       policystats.AgencyNumber,\n       policystats.StatLineCd,\n       policystats.BureauCd,\n       policystats.MajorPerilCd,\n       policystats.CommissionPct,\n       policystats.CommissionAmt,\n       policystats.VariableCd1,\n       policystats.VariableCd2,\n       policystats.SubLineCd,\n       policystats.RiskTerritory,\n       policystats.Exposure,\n       policystats.ProductName,\n       policystats.PolicySource,\n       policystats.NumericTransactionCd,\n       policystats.NumOfFamilies,\n       policystats.BCEGS,\n       policystats.ExceptionCd,\n       policystats.ProtectDeviceCode,\n       policystats.SprinklerCode,\n       policystats.TransactionExpDt,\n       policystats.Suggestion,\n       policystats.UnderlyingPersonalLiability,\n       policystats.UmbEndorsementInd,\n       policystats.UmbPersLiabInd,\n       policystats.UmbAutoPolicyInd,\n       policystats.UmbRiskProfileInd,\n       policystats.ExpenseMod,\n       policystats.IndRiskPremMod,\n       policystats.ActualCashValueInd,\n       policystats.EqTerrCd,\n       policystats.NAICNumber,\n       policystats.ISSNumber,\n       policystats.ISONumber,\n       policystats.PolicyTerm,\n       policystats.County,\n       policystats.City,\n       policystats.ExposureBasis,\n       policystats.BurglaryOptionCd,\n       policystats.SprinklerCd,\n       policystats.NamedPerils,\n       policystats.BuyBackCovg,\n       policystats.SICCd,\n       policystats.TerrorismCovCd,\n       policystats.PolicyFormCd,\n       policystats.CompanyNumber,\n       policystats.MGAIndicator,\n       policystats.MultiPolicyAffiliatedSameCo,\n       policystats.PerPolIndCd,\n       policystats.BondTypeCd,\n       policystats.TypeOfBusiness,\n       policystats.Subline,\n       policystats.TypePolicyCode,\n       policystats.ZipCode,\n       policystats.Deductible3,\n       policystats.ScheduleItemClass,\n       policystats.SchedPremMod,\n       policystats.BldgCounterNumber,\n       policystats.LocationCounterNumber,\n       policystats.BroadCov,\n       policystats.ExtendReptPeriod,\n       policystats.updatetimestamp\nFROM policystats\nwhere policyref in (select policyref\n                    from policystats\n                    where (bookdt >= '2023-10-24 00:00:00.000' and bookdt < '2023-11-24 00:00:00.000') ## also get updated records\n   or (updatetimestamp >= '2023-10-24 00:00:00.000'\n  and updatetimestamp\n    < '2023-11-24 00:00:00.000'\n  and updatetimestamp\n    > bookdt) ) limit 1000"
      },
      "customQuery" : "SELECT policystats.SystemId, policystats.id, policystats.StatSequence, policystats.StatSequenceReplace, policystats.PolicyRef, policystats.ProductVersionIdRef, policystats.PolicyNumber, policystats.PolicyVersion, policystats.LineCd, policystats.TransactionNumber, policystats.CoverageCd, policystats.RiskCd, policystats.RiskTypeCd, policystats.SubTypeCd, policystats.CoverageItemCd, policystats.FeeCd, policystats.EffectiveDt, policystats.ExpirationDt, policystats.CombinedKey, policystats.AddDt, policystats.BookDt, policystats.TransactionEffectiveDt, policystats.AccountingDt, policystats.WrittenPremiumAmt, policystats.WrittenCommissionAmt, policystats.WrittenPremiumFeeAmt, policystats.WrittenCommissionFeeAmt, policystats.EarnDays, policystats.InforceChangeAmt, policystats.PolicyYear, policystats.TermDays, policystats.InsuranceTypeCd, policystats.StartDt, policystats.EndDt, policystats.StatusCd, policystats.NewRenewalCd, policystats.Limit1, policystats.Limit2, policystats.Limit3, policystats.Deductible1, policystats.Deductible2, policystats.AnnualStatementLineCd, policystats.CoinsurancePct, policystats.CoveredPerilsCd, policystats.CommissionKey, policystats.CommissionAreaCd, policystats.RateAreaName, policystats.StatData, policystats.CustomerRef, policystats.ShortRateStatInd, policystats.TransactionCd, policystats.StateCd, policystats.BillMethod, policystats.StatementAccountNumber, policystats.StatementAccountRef, policystats.CarrierGroupCd, policystats.CarrierCd, policystats.ProducerCd, policystats.BusinessSourceCd, policystats.PreviousCarrierCd, policystats.ConstructionCd, policystats.YearBuilt, policystats.SqFt, policystats.Stories, policystats.OccupancyCd, policystats.Units, policystats.ProtectionClass, policystats.TerritoryCd, policystats.PolicyTypeCd, policystats.PolicyStatusCd, policystats.PolicyGroupCd, policystats.CancelReason, policystats.PayPlanCd, policystats.ClassCd, policystats.AgeOfHome, policystats.LocationAddress1, policystats.LocationAddress2, policystats.LocationAddress3, policystats.LocationAddress4, policystats.LocationCity, policystats.LocationCounty, policystats.LocationState, policystats.LocationZip, policystats.LocationRegionCd, policystats.LocationRegionISOCd, policystats.VehicleNumber, policystats.VehicleYear, policystats.VehicleManufacturer, policystats.VehicleModel, policystats.VehicleType, policystats.DriverNumber, policystats.DriverFirst, policystats.DriverMI, policystats.DriverAge, policystats.DriverLast, policystats.DriverGenderCd, policystats.RelationshipToInsuredCd, policystats.DriverStartDt, policystats.PointsChargeable, policystats.PointsCharged, policystats.Limit4, policystats.Limit5, policystats.Limit6, policystats.ControllingStateCd, policystats.ControllingProductVersionIdRef, policystats.DividendPlanCd, policystats.ConversionTemplateIdRef, policystats.ConversionGroup, policystats.ConversionJobRef, policystats.ConversionFileName, policystats.AgencyNumber, policystats.StatLineCd, policystats.BureauCd, policystats.MajorPerilCd, policystats.CommissionPct, policystats.CommissionAmt, policystats.VariableCd1, policystats.VariableCd2, policystats.SubLineCd, policystats.RiskTerritory, policystats.Exposure, policystats.ProductName, policystats.PolicySource, policystats.NumericTransactionCd, policystats.NumOfFamilies, policystats.BCEGS, policystats.ExceptionCd, policystats.ProtectDeviceCode, policystats.SprinklerCode, policystats.TransactionExpDt, policystats.Suggestion, policystats.UnderlyingPersonalLiability, policystats.UmbEndorsementInd, policystats.UmbPersLiabInd, policystats.UmbAutoPolicyInd, policystats.UmbRiskProfileInd, policystats.ExpenseMod, policystats.IndRiskPremMod, policystats.ActualCashValueInd, policystats.EqTerrCd, policystats.NAICNumber, policystats.ISSNumber, policystats.ISONumber, policystats.PolicyTerm, policystats.County, policystats.City, policystats.ExposureBasis, policystats.BurglaryOptionCd, policystats.SprinklerCd, policystats.NamedPerils, policystats.BuyBackCovg, policystats.SICCd, policystats.TerrorismCovCd, policystats.PolicyFormCd, policystats.CompanyNumber, policystats.MGAIndicator, policystats.MultiPolicyAffiliatedSameCo, policystats.PerPolIndCd, policystats.BondTypeCd, policystats.TypeOfBusiness, policystats.Subline, policystats.TypePolicyCode, policystats.ZipCode, policystats.Deductible3, policystats.ScheduleItemClass, policystats.SchedPremMod, policystats.BldgCounterNumber, policystats.LocationCounterNumber, policystats.BroadCov, policystats.ExtendReptPeriod \n,policystats.updatetimestamp\nFROM\n policystats \n where policyref in\n (select policyref from policystats\n where\n (bookdt >= '$$m_strtdt' and bookdt < '$$m_Enddt')\n ##also get updated records\n or (updatetimestamp >= '$$m_strtdt' and updatetimestamp < '$$m_Enddt' and updatetimestamp > bookdt)\n)",
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "DUMMY_Src_policystats",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_SRCM",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$Tgt_PolicyStats_Stg$",
      "type" : "TARGET",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "default" : "dbo/policystats_stg",
        "objectParameterized" : "false",
        "visible" : "false",
        "supportApplyDDLChanges" : "false",
        "originalPath" : "Tgt_PolicyStats_Stg"
      },
      "targetConnectionId" : "@aYZ4ekzHgIPeKpiaoqDLKP",
      "connectionName" : "redshift_nonprod_andover_dw_dev",
      "targetObject" : "dbo/policystats_stg",
      "targetObjectLabel" : "policystats_stg",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "operationType" : "Insert",
      "customFuncCfg" : { },
      "extendedObject" : {
        "singleMode" : true
      },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "dbo/policystats_stg",
      "objectLabel" : "policystats_stg",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    }
  ],
  "verbose" : false,
  "lastRunTime" : 1702393643000,
  "mappingId" : "@7u350V6a1WAcyHDy8KPfsj",
  "mappingTemplateName" : "m_Load_Policystats_to_PolicyStats_Stg_Ld",
  "sessionPropertiesList" : [
    {
      "name" : "Allow Temporary Sequence for Pushdown",
      "value" : "NO"
    },
    {
      "name" : "Allow Temporary View for Pushdown",
      "value" : "NO"
    },
    {
      "name" : "Cache LOOKUP() function",
      "value" : "YES"
    },
    {
      "name" : "Commit On End Of File",
      "value" : "YES"
    },
    {
      "name" : "Data Column Delimiter",
      "value" : "|"
    },
    {
      "name" : "Error Log File Name",
      "value" : "PMError.log"
    },
    {
      "name" : "Log Row Data",
      "value" : "YES"
    },
    {
      "name" : "Pushdown Optimization",
      "value" : "None"
    },
    {
      "name" : "Pushdown Optimization Context",
      "value" : "None"
    },
    {
      "name" : "Pushdown Optimization Fallback Option",
      "value" : "Partial PDO"
    }
  ],
  "inOutParameters" : [
    {
      "name" : "m_strtdt",
      "datatype" : "STRING",
      "precision" : "120",
      "scale" : "0",
      "retentionPolicy" : "NEVER",
      "aggregationType" : "MAX",
      "currentValue" : "2023-10-20 00:00:00.000"
    },
    {
      "name" : "m_Enddt",
      "datatype" : "STRING",
      "precision" : "120",
      "scale" : "0",
      "retentionPolicy" : "NEVER",
      "aggregationType" : "MAX",
      "currentValue" : "2023-10-24 00:00:00.000"
    }
  ],
  "hidden" : false,
  "enableCrossSchemaPushdown" : false,
  "enableParallelRun" : false,
  "autoTunedApplied" : false,
  "autoTunedAppliedType" : "NONE",
  "parameterFileName" : "devidmcsecureagent-secureagent72579156-j5tnwr2hd1yi/parameters/Andover_Param_GW.param",
  "paramFileType" : "PARAM_FILE_CLOUD",
  "schemaMode" : "async",
  "valid" : true,
  "paramFileConnectionId" : "@azEva6zs2GVd8TkGbhUF48",
  "connectionName" : "conn_s3v2_secureagent",
  "allowMaxFieldLength" : false,
  "specialCharacterSupport" : false,
  "midstreamPreview" : false,
  "vcsExportTime" : "2026-01-31 06:36:52 PST"
}