{
  "name" : "s_m_Audit_Load_Balancing_Source_to_Master_Ld_weekly",
  "description" : "Session pushed from PC to ICS : s_m_Audit_Load_Balancing_Source_to_Master_Ld_weekly",
  "runtimeEnvironmentId" : "@94yEUbQ8g09k6LZ0ShdXQQ",
  "runtimeEnvironmentName" : "sag_aws_linux",
  "maxLogs" : 10,
  "parameters" : [
    {
      "name" : "$SQ_Load_Balancing_Source_to_Master$",
      "type" : "SOURCE",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "isSelectDistinct" : "false",
        "objectParameterized" : "false",
        "visible" : "false",
        "originalPath" : "SQ_Load_Balancing_Source_to_Master"
      },
      "sourceConnectionId" : "@5Zcq1VmIGjxlaDWgHTaKA5",
      "connectionName" : "redshift_nonprod_andover_dw_qa",
      "sourceObject" : "DUMMY_SQ_Load_Balancing_Source_to_Master",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "customFuncCfg" : { },
      "customQuery" : "SELECT dbo.load_balancing_source_to_master.Source_Policy_Count, dbo.load_balancing_source_to_master.Source_Claim_count,\n       dbo.load_balancing_source_to_master.Source_MTDWrittenPremiumAmt, dbo.load_balancing_source_to_master.Source_MTDEarnedPremiumAmount,\n       dbo.load_balancing_source_to_master.Source_LossExpense, dbo.load_balancing_source_to_master.Source_LossPaid,\n       dbo.load_balancing_source_to_master.Source_AgencyCommissionCnt, dbo.load_balancing_source_to_master.Source_AgencyCommissionAmt,\n       dbo.load_balancing_source_to_master.Master_Policy_Count, dbo.load_balancing_source_to_master.Master_Claim_count,\n       dbo.load_balancing_source_to_master.Master_MTDWrittenPremiumAmt, dbo.load_balancing_source_to_master.Master_MTDEarnedPremiumAmount,\n       dbo.load_balancing_source_to_master.Master_LossExpense, dbo.load_balancing_source_to_master.Master_LossPaid,\n       dbo.load_balancing_source_to_master.Master_AgencyCommissionCnt, dbo.load_balancing_source_to_master.Master_AgencyCommissionAmt,\n       dbo.load_balancing_source_to_master.Variance_Policy_Count, dbo.load_balancing_source_to_master.Variance_Claim_count,\n       dbo.load_balancing_source_to_master.Variance_MTDWrittenPremiumAmt,\n       dbo.load_balancing_source_to_master.Variance_MTDEarnedPremiumAmount,\n       dbo.load_balancing_source_to_master.Variance_LossExpense, dbo.load_balancing_source_to_master.Variance_LossPaid,\n       dbo.load_balancing_source_to_master.Variance_AgencyCommissionCnt, dbo.load_balancing_source_to_master.Variance_AgencyCommissionAmt,\n       dbo.load_balancing_source_to_master.RowInsDt, dbo.load_balancing_source_to_master.Master_CededPremium,\n       dbo.load_balancing_source_to_master.Master_CededLossPaid, dbo.load_balancing_source_to_master.Variance_CededPremium,\n       dbo.load_balancing_source_to_master.Variance_CededLossPaid, dbo.load_balancing_source_to_master.Source_CededPremium,\n       dbo.load_balancing_source_to_master.Source_CededLossPaid\nFROM\n dbo.load_balancing_source_to_master where RowInsDt in (\nselect Max(RowInsDt) from dbo.load_balancing_source_to_master)",
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "DUMMY_SQ_Load_Balancing_Source_to_Master",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$SQ_master_stats$",
      "type" : "SOURCE",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "isSelectDistinct" : "false",
        "objectParameterized" : "false",
        "visible" : "false",
        "originalPath" : "SQ_master_stats"
      },
      "sourceConnectionId" : "@5Zcq1VmIGjxlaDWgHTaKA5",
      "connectionName" : "redshift_nonprod_andover_dw_qa",
      "sourceObject" : "DUMMY_SQ_master_stats",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "customFuncCfg" : { },
      "customQuery" : "select coalesce(Policy_Count,0) as Policy_Count,\ncoalesce(Claim_count,0) as Claim_Count, \ncoalesce((MTDWrittenPremiumAmt+Fact_MTDWrittenPremiumAmt)/2,0) as MTDWrittenPremiumAmt, \ncoalesce((MTDEarnedPremiumAmt+Fact_MTDEarnedPremiumAmt)/2,0) as MTDEarnedPremiumAmt, \ncoalesce(MTDLossExpense,0) as MTDLossExpense,\ncoalesce(MTDLossPaid,0) as MTDLossPaid,\ncoalesce(AgencyCommissionCnt,0) as AgencyCommissionCnt,\ncoalesce(AgencyCommissionAmt,0) as AgencyCommissionAmt,\nAccount_Entered_Dt,\ncoalesce(CededPremium,0) as CededPremium,\ncoalesce(CededLossPaid,0) as CededLossPaid\n\nfrom \n(select max(account_entered_dt) as Account_Entered_Dt,\nmax(Policy_Count) as Policy_Count,\nmax(Claim_count) as Claim_count,\nmax(MTDWrittenPremiumAmt) as MTDWrittenPremiumAmt,\nmax(MTDEarnedPremiumAmt) as MTDEarnedPremiumAmt,\nmax(LossExpense) as MTDLossExpense,\nmax(LossPaid) as MTDLossPaid,\nmax(Fact_MTDWrittenPremiumAmt) as Fact_MTDWrittenPremiumAmt,\nmax(Fact_MTDEarnedPremiumAmt) as Fact_MTDEarnedPremiumAmt,\nmax(CededPremium) as CededPremium,\nmax(CededLossPAid) as CededLossPaid,\nmax(CommissionCnt) as AgencyCommissionCnt,\nmax(CommissionAmt) as AgencyCommissionAmt\nfrom \n(select count(policykey) as Policy_Count from \n(select distinct policykey from dbo.policydetail where PolicyInceptionDt <= GETDATE() - 1)x\nwhere policykey not in ('SBP37027088000','SBP37068579000'))BP\nleft join \n(select count(claimnumber) as Claim_count from \n(select distinct claimnumber from dbo.claimdetail where LossReportedDt <= GETDATE() - 1 and RowEffEndDt > GETDATE())r)C\non 1=1\nleft join\n(select coalesce(sum(LossULAEExpense) + sum(LossALAEExpense), 0) as LossExpense,\ncoalesce(sum(LossPaidAmt), 0) as LossPaid \nfrom dbo.claimtransaction \nwhere\nroweffenddt = '9999-12-31'\nand date_part(y,LossAccountEnteredDate) = date_part(y,getdate() - 1)\nand date_part(mon,LossAccountEnteredDate) = date_part(mon,getdate() - 1)\nand BookDt < cast(CURRENT_TIMESTAMP as date))CMS\non 1=1\nleft join \n(select coalesce(sum(WrittenPremiumAmt), 0) as MTDWrittenPremiumAmt\nfrom dbo.PolicyTransaction\nwhere \nRowEffEndDt = '9999-12-31'\nand date_part(y,TransactionAccountingDt) = date_part(y,getdate() - 1)\nand date_part(mon,TransactionAccountingDt) = date_part(mon,getdate() - 1) \nand BookDt < cast(CURRENT_TIMESTAMP as date)\n)PSS\non 1=1\nleft join\n(select coalesce(sum(MTDEarnedPremiumAmount), 0) as MTDEarnedPremiumAmt\nfrom dbo.EarnedPremiumFact\nwhere substring(reportperiod,1,4)=date_part(y,getdate() - 1)\nand cast(substring(reportperiod,5,2) as integer)=date_part(mon,getdate() - 1)\n) EP\non 1=1\nleft join \n(select account_entered_dt,coalesce(sum(written_premium),0) as Fact_MTDWrittenPremiumAmt,coalesce(sum(Earned_Premium),0) as Fact_MTDEarnedPremiumAmt from  dbo.Fact_Agg_GW_Premiums\nwhere date_part(y,account_entered_dt)=date_part(y,getdate() - 1)\nand date_part(mon,account_entered_dt)=date_part(mon,getdate() - 1)\ngroup by account_entered_dt\n)Fact\non 1=1\nleft join \n(select AccountEnteredDt, coalesce(sum(PaidAmt),0) as CededLossPAid from  dbo.ClaimReinsuranceTransaction\nwhere date_part(y,AccountEnteredDt)=date_part(y,getdate() - 1)\nand date_part(mon,AccountEnteredDt)=date_part(mon,getdate() - 1)\nand BookDt < cast(getdate() as date)\ngroup by AccountEnteredDt\n)CededLoss\non 1=1\nleft join \n(select AccountEnteredDt, coalesce(sum(WrittenPremiumAmt),0) as CededPremium from  dbo.PolicyreinsuranceTransaction\nwhere date_part(y,AccountEnteredDt)=date_part(y,getdate() - 1)\nand date_part(mon,AccountEnteredDt)=date_part(mon,getdate() - 1)\nand BookDt < cast(getdate() as date)\nand RowEffEndDt = '9999-12-31'\ngroup by AccountEnteredDt\n)CededPremium\non 1=1\nleft join\n(\nSelect count(*) as CommissionCnt ,coalesce(sum(commissionamt),0) as CommissionAmt from dbo.AgencyCommissionDetail \n)ag\non 1=1\n)MTDLoadBalancing",
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "DUMMY_SQ_master_stats",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$SQ_source_stats$",
      "type" : "SOURCE",
      "label" : "DBConnection_SRCM",
      "uiProperties" : {
        "cnxtype" : "MySQL",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_SRCM",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_SRCM",
        "isSelectDistinct" : "false",
        "objectParameterized" : "false",
        "visible" : "false",
        "originalPath" : "SQ_source_stats"
      },
      "sourceConnectionId" : "@lclFT82DAAyjTBYcXwsTI3",
      "connectionName" : "conn_mysql_prod_insurance_now_gw-legacy",
      "sourceObject" : "DUMMY_SQ_source_stats",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "customFuncCfg" : { },
      "customQuery" : "SELECT \ncoalesce(Policy_Count,0) as Policy_Count,\ncoalesce(Claim_count,0) as Claim_Count,\ncoalesce(MTDWrittenPremiumAmt,0) as MTDWrittenPremiumAmt,\ncoalesce(MTDEarnedPremiumAmount,0) as MTDEarnedPremiumAmount,\ncoalesce(LossExpense,0) as LossExpense,\ncoalesce(LossPaid,0) as LossPaid,\ncoalesce(AgencyCommissionCnt,0) as AgencyCommissionCnt,\ncoalesce(AgencyCommissionAmt,0) as AgencyCommissionAmt,\ncoalesce(CededPremium,0) as CededPremium,\ncoalesce(CededLossPaid,0) as CededLossPaid\nFROM\n(select \nmax(Policy_Count) as Policy_Count,\nmax(Claim_count) as Claim_count,\nmax(MTDWrittenPremiumAmt) as MTDWrittenPremiumAmt,\nmax(MTDEarnedPremiumAmount) as MTDEarnedPremiumAmount,\n(sum(ULAEExpense)+sum(ALAEExpense)) as LossExpense,\nsum(LossPaid) as LossPaid ,\nmax(CommissionCnt) as AgencyCommissionCnt,\nSum(CommissionAmt ) as AgencyCommissionAmt,\nmax(cp.CededPremiumAmt) as CededPremium\n,max(cl.CededPaidloss) as CededlossPaid\nfrom \n(select count(policykey) as Policy_Count \nfrom \n(select distinct concat(policynumber,policyversion) as policykey \nfrom basicpolicy where cmmcontainer='policy' \nand inceptiondt <= date_add(current_date() , INTERVAL -1 DAY)\n)x)BP\nleft join \n(select count(claimnumber) as Claim_count \nfrom \n(select distinct claimnumber \nfrom claim \nwhere \nclaim.cmmcontainer='Claim' \nand ReportedDt <= date_add(current_date() , INTERVAL -1 DAY)\n)r)C\non 1=1\nleft join\n(SELECT \nsum(case when Reservecd in ('Adjustment') then PaidAmt else 0 end) as ULAEExpense,\nsum(case when ReserveCd='DEFENSE' then PaidAmt else 0 end) as ALAEExpense,\nsum(case when ReserveCd='Indemnity' then PaidAmt else 0 end) as LossPaid\nfrom ClaimStats  ClaimStats_stg \nwhere year(bookdt) = year(date_add(current_date() , INTERVAL -1 DAY))\nand month(bookdt) = month(date_add(current_date() , INTERVAL -1 DAY))\nand bookdt < current_date())CS\non 1=1\nleft join \n(select \ncoalesce(sum(WrittenPremiumAmt),0) as MTDWrittenPremiumAmt \nfrom policystats \nwhere year(accountingDt) = year(date_add(current_date() , INTERVAL -1 DAY))\nand month(accountingDt) = month(date_add(current_date() , INTERVAL -1 DAY))\nand BookDt < current_date() )PSS\non 1=1\nleft join\n(\nSelect count(*) as CommissionCnt,sum(coalesce(CommissionAmt,0)) as CommissionAmt from CommissionDetail\n)agency\non 1=1\nleft join \n(select sum(coalesce(mtdearnedpremiumamt,0)) as MTDEarnedPremiumAmount from policysummarystats\nwhere reportperiod = DATE_FORMAT(CURDATE(), '%Y%m')\nand coalesce(feecd,'') not in ('HealthyHomesFundFee', 'NJGFFee', 'NYFFFee') #exclude CT healthy homes and NJ Guarantee Fund\nand updatedt<current_date()\n)ep\non 1=1\nleft join\n(select \ncoalesce(sum(WrittenPremiumAmt),0) as CededPremiumAmt \nfrom policyReinsurancestats \nwhere year(accountingDt) = year(date_add(current_date() , INTERVAL -1 DAY))\nand month(accountingDt) = month(date_add(current_date() , INTERVAL -1 DAY))\nand BookDt < current_date()\n )CP\non 1=1\nleft join \n(select \nsum(coalesce(PaidAmt,0)) as CededPaidLoss\nfrom claimreinsurancestats \nwhere year(BookDt) = year(date_add(current_date() , INTERVAL -1 DAY))\nand month(BookDt) = month(date_add(current_date() , INTERVAL -1 DAY))\nand BookDt < current_date() )CL\non 1=1\n)SRCLoadBalancing",
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "DUMMY_SQ_source_stats",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_SRCM",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$Load_Balancing_Source_to_Master_ERR$",
      "type" : "TARGET",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "default" : "dbo/load_balancing_source_to_master",
        "objectParameterized" : "false",
        "visible" : "false",
        "supportApplyDDLChanges" : "false",
        "originalPath" : "Load_Balancing_Source_to_Master_ERR"
      },
      "targetConnectionId" : "@5Zcq1VmIGjxlaDWgHTaKA5",
      "connectionName" : "redshift_nonprod_andover_dw_qa",
      "targetObject" : "dbo/load_balancing_source_to_master",
      "targetObjectLabel" : "load_balancing_source_to_master",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "operationType" : "Insert",
      "customFuncCfg" : { },
      "extendedObject" : {
        "singleMode" : true
      },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "dbo/load_balancing_source_to_master",
      "objectLabel" : "load_balancing_source_to_master",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$Load_Balancing_Source_to_Master_INS$",
      "type" : "TARGET",
      "label" : "DBConnection_TGT",
      "uiProperties" : {
        "cnxtype" : "Amazon Redshift v2",
        "connectionParameterized" : "true",
        "paramName" : "DBConnection_TGT",
        "paramType-mapping" : "Connection",
        "logcnx" : "DBConnection_TGT",
        "default" : "dbo/load_balancing_source_to_master",
        "objectParameterized" : "false",
        "visible" : "false",
        "supportApplyDDLChanges" : "false",
        "originalPath" : "Load_Balancing_Source_to_Master_INS"
      },
      "targetConnectionId" : "@5Zcq1VmIGjxlaDWgHTaKA5",
      "connectionName" : "redshift_nonprod_andover_dw_qa",
      "targetObject" : "dbo/load_balancing_source_to_master",
      "targetObjectLabel" : "load_balancing_source_to_master",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "operationType" : "Insert",
      "customFuncCfg" : { },
      "extendedObject" : {
        "singleMode" : true
      },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "dbo/load_balancing_source_to_master",
      "objectLabel" : "load_balancing_source_to_master",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "DBConnection_TGT",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    }
  ],
  "verbose" : false,
  "mappingId" : "@0Kh1fmMT3HZhXFLR9G1Ysq",
  "mappingTemplateName" : "m_Audit_Load_Balancing_Source_to_Master_Ld_Weekly",
  "sessionPropertiesList" : [
    {
      "name" : "Allow Temporary Sequence for Pushdown",
      "value" : "NO"
    },
    {
      "name" : "Allow Temporary View for Pushdown",
      "value" : "NO"
    },
    {
      "name" : "Commit Interval",
      "value" : "10000"
    },
    {
      "name" : "Commit On End Of File",
      "value" : "YES"
    },
    {
      "name" : "Commit Type",
      "value" : "Target"
    },
    {
      "name" : "Data Column Delimiter",
      "value" : "|"
    },
    {
      "name" : "Pushdown Optimization",
      "value" : "None"
    },
    {
      "name" : "Pushdown Optimization Context",
      "value" : "None"
    },
    {
      "name" : "Pushdown Optimization Fallback Option",
      "value" : "Partial PDO"
    },
    {
      "name" : "Treat source rows as",
      "value" : "Insert"
    }
  ],
  "hidden" : false,
  "enableCrossSchemaPushdown" : false,
  "enableParallelRun" : false,
  "autoTunedApplied" : false,
  "autoTunedAppliedType" : "NONE",
  "parameterFileName" : "Andover_Param_GW.param",
  "parameterFileDir" : "$PMRootDir/andover/parameters",
  "paramFileType" : "PARAM_FILE_LOCAL",
  "schemaMode" : "async",
  "valid" : true,
  "jobPriority" : "MEDIUM",
  "optimizationPlan" : "NONE",
  "allowMaxFieldLength" : false,
  "specialCharacterSupport" : false,
  "midstreamPreview" : false,
  "vcsExportTime" : "2026-01-31 12:50:20 PST"
}