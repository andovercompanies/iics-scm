{
  "content" : {
    "description" : "The Hamming Distance algorithm calculates a match score for two data strings by computing the number of positions in which characters differ between the data strings. For strings of different length, the algorithm counts each additional character in the longest string as a difference between the strings.",
    "allowMaxFieldLength" : "false",
    "documentType" : "DMAPPLET",
    "name" : "mplt_Comparison_ReverseHammingDistance",
    "specialCharacterSupport" : "false",
    "links" : [
      {
        "link" : "ReverseHammingDistance -> ReverseHammingDistance_Output"
      },
      {
        "link" : "ReverseHammingDistance_Input -> ReverseHammingDistance"
      }
    ],
    "transformations" : [
      {
        "createTime" : "2022-10-27T14:25:59.170Z",
        "name" : "ReverseHammingDistance_Input",
        "groups" : [
          {
            "input" : "false",
            "name" : "DefaultGroup",
            "output" : "true"
          }
        ],
        "fields" : [
          {
            "description" : "First string value",
            "name" : "string1",
            "platformType" : {
              "name" : "string"
            },
            "precision" : 512,
            "scale" : 0
          },
          {
            "description" : "Second string value",
            "name" : "string2",
            "platformType" : {
              "name" : "string"
            },
            "precision" : 512,
            "scale" : 0
          },
          {
            "description" : "Score when one of the inputs is null",
            "name" : "singleFieldNull",
            "platformType" : {
              "name" : "double"
            },
            "precision" : 15,
            "scale" : 0
          },
          {
            "description" : "Score when both fields are null",
            "name" : "bothFieldsNull",
            "platformType" : {
              "name" : "double"
            },
            "precision" : 15,
            "scale" : 0
          }
        ]
      },
      {
        "createTime" : "2022-10-27T14:25:59.172Z",
        "name" : "ReverseHammingDistance_Output",
        "groups" : [
          {
            "input" : "true",
            "name" : "DefaultGroup",
            "output" : "false",
            "rules" : [
              {
                "bulkRename" : "false",
                "include" : "true"
              }
            ]
          }
        ],
        "fieldMappingMode" : "MANUAL",
        "fields" : [
          {
            "name" : "score",
            "platformType" : {
              "name" : "double"
            },
            "precision" : 15,
            "scale" : 0
          }
        ],
        "manualMappings" : {
          "mappingList" : [
            {
              "fromFieldName" : "score",
              "toField" : {
                "name" : "score"
              }
            }
          ]
        }
      },
      {
        "createTime" : "2022-10-27T17:35:26.186Z",
        "name" : "ReverseHammingDistance",
        "advancedProperties" : [
          {
            "name" : "Tracing Level",
            "value" : "Normal"
          },
          {
            "name" : "Transformation Scope",
            "value" : "Row"
          },
          {
            "name" : "Update Strategy Transformation",
            "value" : "false"
          },
          {
            "name" : "Enable_High_Precision",
            "value" : "false"
          },
          {
            "name" : "Optional",
            "value" : "true"
          },
          {
            "name" : "Is Active",
            "value" : "false"
          },
          {
            "name" : "Use_Nano_Seconds_In_Datetime",
            "value" : "false"
          }
        ],
        "groups" : [
          {
            "input" : "true",
            "name" : "DefaultGroup",
            "output" : "true",
            "rules" : [
              {
                "bulkRename" : "false",
                "include" : "true"
              }
            ]
          }
        ],
        "helperCodeSnippet" : "private static final double  DEFAULT_SINGLE_NULL_DISTANCE = onPremiseRoundError(0.5);\nprivate static final double  DEFAULT_DOUBLE_NULL_DISTANCE = onPremiseRoundError(0.5);\n\t\nprivate double  singleNullDistanceScore = DEFAULT_SINGLE_NULL_DISTANCE;\nprivate double  doubleNullDistanceScore = DEFAULT_DOUBLE_NULL_DISTANCE;\nprivate boolean initialized = false;\n\t\n/*\n * There is a bug in the on-premise product where the single / double null distance values\n * have a float to double rounding error. For example, if the user specifies one of the \n * values to be 0.9, the actual value output is 0.8999999761581421. This is because somewhere\n * in the on-premise product, the initial \"0.9\" is a float that gets converted the output\n * data type of double.\n */\nprivate static double onPremiseRoundError(final double val) {\n  float f = (float)val;\n  return (double)f;\n}\n\nprivate double computeReverseHammingDistance(String sA, String sB) {\n  // We want A to be the longer string\n  String stringA = sA;\n  String stringB = sB;\n  if (stringB.length() > stringA.length()) {\n    stringA = sB;\n    stringB = sA;\n  }\n\n  int lenA  = stringA.length();\n  int lenB  = stringB.length();\n  int diffs = lenA - lenB;\n\n  // As string A is longer, move along the buffer so that it's the same length as stringB\n  int offsetA = lenA - lenB;\n\n  for (int iChar = 0; iChar < lenB; iChar++) {\n    if (stringA.charAt(iChar+offsetA) != stringB.charAt(iChar)) {\n      diffs++;\n    }\n  }\n\n  return 1.0 - (double)diffs / (double)lenA;\n}\n\n\n\n",
        "importPackagesSnippet" : "\n",
        "lastCompilationFailed" : "false",
        "onEndOfDataMethodSnippet" : "\n\n",
        "onInputRowMethodSnippet" : "// Initialization\nif ( ! initialized ) {\n  if (!isNull(\"singleFieldNull\")) {\n    singleNullDistanceScore = onPremiseRoundError(singleFieldNull);\n  }\n  if (!isNull(\"bothFieldsNull\")) {\n    doubleNullDistanceScore = onPremiseRoundError(bothFieldsNull);\n  }\n  initialized = true;\n}\n\n// Compute score\nif (isNull(\"string1\")){\n  if (isNull(\"string2\")) {\n    score = doubleNullDistanceScore;\n  } else {\n    score = singleNullDistanceScore;\n  }\n} else if (isNull(\"string2\")) {\n  score = singleNullDistanceScore;\n} else {\n  score = computeReverseHammingDistance(string1,string2);\n}\n\n",
        "onTransactionMethodSnippet" : "// TODO: Enter the code that executes when the transformation receives a transaction here.\n",
        "runtimeEnvId" : "01A6IV25000000000002",
        "sorterModeJava" : "SIMPLE",
        "unmodifiedCompilation" : "true",
        "compiledInputFields" : [
          {
            "name" : "string1",
            "precision" : 512,
            "scale" : 0,
            "type" : "string"
          },
          {
            "name" : "string2",
            "precision" : 512,
            "scale" : 0,
            "type" : "string"
          },
          {
            "name" : "singleFieldNull",
            "precision" : 15,
            "scale" : 0,
            "type" : "double"
          },
          {
            "name" : "bothFieldsNull",
            "precision" : 15,
            "scale" : 0,
            "type" : "double"
          }
        ],
        "outputFields" : [
          {
            "name" : "score",
            "platformType" : {
              "name" : "double"
            },
            "precision" : 15,
            "scale" : 0
          }
        ]
      }
    ]
  },
  "vcsExportTime" : "2026-01-31 06:29:18 PST"
}